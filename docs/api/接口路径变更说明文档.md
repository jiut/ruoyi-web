# 🔄 设计师模块接口路径变更说明文档

## 📋 概述

本文档记录了设计师模块中所有接口路径的变更，包括已完成的修改和需要修复的路径冲突问题。前端开发人员需要根据此文档更新相应的API调用。

**文档生成时间**: 2025-01-27  
**影响范围**: 前端所有设计师模块相关的API调用  
**变更类型**: 路径规范化，去除冗余 `/user/` 路径段

---

## ✅ 已修复：路径冲突问题

### 1. SchoolController 路径冲突 ✅ 已解决

**问题描述**: 存在路径冲突，已完成修复

**冲突路径**:
```
GET /designer/school/{schoolId}  # 获取院校详情
GET /designer/school/{userId}    # 根据用户ID查询院校 ❌ 冲突!
```

**修复结果**:
```
✅ 保持: GET /designer/school/{schoolId}          # 获取院校详情
✅ 已修改: GET /designer/school/user/{userId}       # 根据用户ID查询院校
```

### 2. EnterpriseController 路径冲突 ✅ 已解决

**问题描述**: 存在路径冲突，已完成修复

**冲突路径**:
```
GET /designer/enterprise/{enterpriseId}  # 获取企业详情
GET /designer/enterprise/{userId}        # 根据用户ID查询企业 ❌ 冲突!
```

**修复结果**:
```
✅ 保持: GET /designer/enterprise/{enterpriseId}       # 获取企业详情
✅ 已修改: GET /designer/enterprise/user/{userId}        # 根据用户ID查询企业
```

---

## ✅ 已完成的路径变更

### 1. 路径冲突修复

| 功能 | 变更前 | 变更后 | HTTP方法 | 控制器 |
|------|--------|--------|----------|--------|
| 根据用户ID查询院校 | `GET /designer/school/{userId}` | `GET /designer/school/user/{userId}` | GET | SchoolController |
| 根据用户ID查询企业 | `GET /designer/enterprise/{userId}` | `GET /designer/enterprise/user/{userId}` | GET | EnterpriseController |

### 2. UserRegistrationController 基础路径

**变更前**: `/designer/user`  
**变更后**: `/designer`  
**影响**: 该控制器下的所有接口路径都发生了变化

#### 1.1 身份注册接口

| 功能 | 变更前 | 变更后 | HTTP方法 |
|------|--------|--------|----------|
| 注册设计师身份 | `POST /designer/user/register/designer` | `POST /designer/register/designer` | POST |
| 注册企业身份 | `POST /designer/user/register/enterprise` | `POST /designer/register/enterprise` | POST |
| 注册院校身份 | `POST /designer/user/register/school` | `POST /designer/register/school` | POST |

#### 1.2 档案管理接口

| 功能 | 变更前 | 变更后 | HTTP方法 |
|------|--------|--------|----------|
| 获取用户绑定信息 | `GET /designer/user/bindings` | `GET /designer/bindings` | GET |
| 获取设计师档案 | `GET /designer/user/designer/profile` | `GET /designer/designer/profile` | GET |
| 更新设计师档案 | `PUT /designer/user/designer/profile` | `PUT /designer/designer/profile` | PUT |
| 获取企业档案 | `GET /designer/user/enterprise/profile` | `GET /designer/enterprise/profile` | GET |
| 更新企业档案 | `PUT /designer/user/enterprise/profile` | `PUT /designer/enterprise/profile` | PUT |
| 获取院校档案 | `GET /designer/user/school/profile` | `GET /designer/school/profile` | GET |
| 更新院校档案 | `PUT /designer/user/school/profile` | `PUT /designer/school/profile` | PUT |

#### 1.3 绑定管理接口

| 功能 | 变更前 | 变更后 | HTTP方法 |
|------|--------|--------|----------|
| 解绑用户身份 | `PUT /designer/user/unbind/{entityType}` | `PUT /designer/unbind/{entityType}` | PUT |
| 管理员绑定用户实体 | `POST /designer/user/bind` | `POST /designer/bind` | POST |
| 绑定已有企业 | `POST /designer/user/bind/enterprise` | `POST /designer/bind/enterprise` | POST |
| 绑定已有院校 | `POST /designer/user/bind/school` | `POST /designer/bind/school` | POST |

#### 1.4 数据查询接口

| 功能 | 变更前 | 变更后 | HTTP方法 |
|------|--------|--------|----------|
| 获取可绑定企业列表 | `GET /designer/user/available/enterprises` | `GET /designer/available/enterprises` | GET |
| 获取可绑定院校列表 | `GET /designer/user/available/schools` | `GET /designer/available/schools` | GET |

#### 1.5 院校专属功能接口

| 功能 | 变更前 | 变更后 | HTTP方法 |
|------|--------|--------|----------|
| 添加获奖作品展示 | `POST /designer/user/school/award-works` | `POST /designer/school/award-works` | POST |
| 设置课程体系 | `POST /designer/user/school/course-groups` | `POST /designer/school/course-groups` | POST |

---

## 📋 前端代码修改清单

### 1. ✅ 已完成：路径冲突修复

```javascript
// ❌ 修改前 - 存在冲突
const getSchoolByUserId = (userId) => {
    return request.get(`/designer/school/${userId}`);
};

// ✅ 修改后 - 冲突已解决
const getSchoolByUserId = (userId) => {
    return request.get(`/designer/school/user/${userId}`);
};

// ❌ 修改前 - 存在冲突  
const getEnterpriseByUserId = (userId) => {
    return request.get(`/designer/enterprise/${userId}`);
};

// ✅ 修改后 - 冲突已解决
const getEnterpriseByUserId = (userId) => {
    return request.get(`/designer/enterprise/user/${userId}`);
};
```

### 2. UserRegistrationController 路径更新

#### 2.1 身份注册API

```javascript
// ❌ 修改前
const registerDesigner = (data) => {
    return request.post('/designer/user/register/designer', data);
};

const registerEnterprise = (data) => {
    return request.post('/designer/user/register/enterprise', data);
};

const registerSchool = (data) => {
    return request.post('/designer/user/register/school', data);
};

// ✅ 修改后
const registerDesigner = (data) => {
    return request.post('/designer/register/designer', data);
};

const registerEnterprise = (data) => {
    return request.post('/designer/register/enterprise', data);
};

const registerSchool = (data) => {
    return request.post('/designer/register/school', data);
};
```

#### 2.2 档案管理API

```javascript
// ❌ 修改前
const getUserBindings = () => {
    return request.get('/designer/user/bindings');
};

const getDesignerProfile = () => {
    return request.get('/designer/user/designer/profile');
};

const updateDesignerProfile = (data) => {
    return request.put('/designer/user/designer/profile', data);
};

const getEnterpriseProfile = () => {
    return request.get('/designer/user/enterprise/profile');
};

const updateEnterpriseProfile = (data) => {
    return request.put('/designer/user/enterprise/profile', data);
};

const getSchoolProfile = () => {
    return request.get('/designer/user/school/profile');
};

const updateSchoolProfile = (data) => {
    return request.put('/designer/user/school/profile', data);
};

// ✅ 修改后
const getUserBindings = () => {
    return request.get('/designer/bindings');
};

const getDesignerProfile = () => {
    return request.get('/designer/designer/profile');
};

const updateDesignerProfile = (data) => {
    return request.put('/designer/designer/profile', data);
};

const getEnterpriseProfile = () => {
    return request.get('/designer/enterprise/profile');
};

const updateEnterpriseProfile = (data) => {
    return request.put('/designer/enterprise/profile', data);
};

const getSchoolProfile = () => {
    return request.get('/designer/school/profile');
};

const updateSchoolProfile = (data) => {
    return request.put('/designer/school/profile', data);
};
```

#### 2.3 绑定管理API

```javascript
// ❌ 修改前
const unbindUserIdentity = (entityType) => {
    return request.put(`/designer/user/unbind/${entityType}`);
};

const bindUserToEntity = (userId, entityType, entityId) => {
    return request.post('/designer/user/bind', { userId, entityType, entityId });
};

const bindToExistingEnterprise = (enterpriseId, inviteCode) => {
    return request.post('/designer/user/bind/enterprise', { enterpriseId, inviteCode });
};

const bindToExistingSchool = (schoolId, studentId) => {
    return request.post('/designer/user/bind/school', { schoolId, studentId });
};

// ✅ 修改后
const unbindUserIdentity = (entityType) => {
    return request.put(`/designer/unbind/${entityType}`);
};

const bindUserToEntity = (userId, entityType, entityId) => {
    return request.post('/designer/bind', { userId, entityType, entityId });
};

const bindToExistingEnterprise = (enterpriseId, inviteCode) => {
    return request.post('/designer/bind/enterprise', { enterpriseId, inviteCode });
};

const bindToExistingSchool = (schoolId, studentId) => {
    return request.post('/designer/bind/school', { schoolId, studentId });
};
```

#### 2.4 数据查询API

```javascript
// ❌ 修改前
const getAvailableEnterprises = (params) => {
    return request.get('/designer/user/available/enterprises', { params });
};

const getAvailableSchools = (params) => {
    return request.get('/designer/user/available/schools', { params });
};

// ✅ 修改后
const getAvailableEnterprises = (params) => {
    return request.get('/designer/available/enterprises', { params });
};

const getAvailableSchools = (params) => {
    return request.get('/designer/available/schools', { params });
};
```

#### 2.5 院校专属功能API

```javascript
// ❌ 修改前
const addAwardWork = (data) => {
    return request.post('/designer/user/school/award-works', data);
};

const addCourseGroup = (data) => {
    return request.post('/designer/user/school/course-groups', data);
};

// ✅ 修改后
const addAwardWork = (data) => {
    return request.post('/designer/school/award-works', data);
};

const addCourseGroup = (data) => {
    return request.post('/designer/school/course-groups', data);
};
```

---

## 🎯 修改优先级

### ✅ 已完成
1. **路径冲突修复**: SchoolController 和 EnterpriseController 中的用户ID查询接口 ✅
2. **UserRegistrationController 基础路径**: 从 `/designer/user` 更改为 `/designer` ✅

### 🔥 高优先级（立即修改）
1. **身份注册API**: 注册设计师、企业、院校身份的接口
2. **档案管理API**: 获取和更新各种档案信息的接口

### 🟡 中优先级（尽快修改）
1. **绑定管理API**: 绑定和解绑身份的接口
2. **数据查询API**: 获取可绑定实体列表的接口

### 🟢 低优先级（计划修改）
1. **院校专属功能API**: 院校特有的功能接口

---

## 📝 测试建议

### 1. 接口测试清单

在修改前端代码后，建议按以下顺序进行测试：

1. **基础功能测试**
   - [ ] 用户身份注册功能
   - [ ] 用户绑定信息查询
   - [ ] 档案信息获取和更新

2. **权限测试**
   - [ ] 不同角色的接口访问权限
   - [ ] 用户只能操作自己的数据

3. **数据查询测试**
   - [ ] 可绑定实体列表查询
   - [ ] 分页和筛选功能

### 2. 回归测试重点

- 确保所有相关页面能正常加载
- 验证数据提交和更新功能正常
- 检查错误处理和提示信息

---

## 📞 联系支持

如在修改过程中遇到问题，请联系：
- **后端开发团队**: 提供接口详细说明
- **文档维护者**: 更新接口文档
- **测试团队**: 协助功能验证

---

## 📅 变更记录

| 日期 | 变更内容 | 影响范围 | 状态 |
|------|----------|----------|------|
| 2025-01-27 | 创建接口变更文档 | 所有设计师模块前端调用 | ✅ 已完成 |
| 2025-01-27 | 修复SchoolController路径冲突 | `/designer/school/{userId}` → `/designer/school/user/{userId}` | ✅ 已完成 |
| 2025-01-27 | 修复EnterpriseController路径冲突 | `/designer/enterprise/{userId}` → `/designer/enterprise/user/{userId}` | ✅ 已完成 |
| 2025-01-27 | UserRegistrationController路径更新 | `/designer/user/*` → `/designer/*` | ✅ 已完成 |
| 2025-01-27 | 文档结构优化和完善 | 所有接口变更说明 | ✅ 已完成 |
| 2025-01-27 | 四份核心文档同步更新 | API文档、注册流程方案、任务文档 | ✅ 已完成 |

---

**注意**: 请在修改前端代码时同步更新相关的Mock数据和测试用例，确保开发和测试环境的一致性。 